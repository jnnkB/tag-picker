/*!
 * ==============================================================
 *  TAG PICKER 3.0.6
 * ==============================================================
 * Author: Taufik Nurrohman <https://github.com/taufik-nurrohman>
 * License: MIT
 * --------------------------------------------------------------
 */
!function(t,n,e){function i(t,n){var e=n[B](t);return 0>e?null:e}function u(t,n){return t[C].remove(n)}function a(t,n){return t[C].add(n)}function r(t){return Object.keys(t).length}function s(t,n){return Object.assign(t,n)}function o(t,n){return n[B](t)>=0}function c(t){return"function"==typeof t}function f(t){return"number"==typeof t}function l(t){return void 0!==t}function g(t){return"string"==typeof t}function d(t){p(t)&&t[H][G](t)}function p(t){return t&&t[H]}function v(t,e,i){var u,a,r=g(t)?n[E](t):t;if((e||""===e)&&(r[D]=e),i)for(u in i)a=i[u],null===a||!1===a?r[F](u):r[Q](u,a);return r}var m="Arrow",h=m+"Left",b=m+"Right",x="Backspace",y="Delete",k="Enter",w="Tab",j="__instance__",M="appendChild",T="children",C="classList",E="createElement",L="ctrlKey",R="disabled",_="firstChild",A="forEach",O="getAttribute",B="indexOf",D="innerHTML",I="insertBefore",K="key",N=K+"Code",S="nextSibling",z="nodeName",H="parentNode",P="previousSibling",q="readOnly",F="removeAttribute",G="removeChild",J="replace",Q="setAttribute",U="shiftKey",V="textContent",W="toLowerCase",X=setTimeout;!function(t){t.version="3.0.6",t[j]={},t.each=function(n,e){var i,u;return X(function(){u=t[j];for(i in u)n.call(u[i],i)},0===e?0:e||1),t},t.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},t.i=function(n,e){return n=t.I[n]||n,e&&e[A](function(t){n=n[J]("%"+(f(t)?"d":"s"),t)}),n},t._=t.prototype}(t[e]=function(n,p){function m(t,n,e){return l(Rn[t])||(Rn[t]={}),l(e)||(e=r(Rn[t])),Rn[t][e]=n,jn}function C(t,n){return l(t)?l(n)?(delete Rn[t][n],jn):(Rn[t]={},jn):(Rn={},jn)}function E(t,n,e){if(!l(Rn[t]))return jn;if(l(e))l(Rn[t][e])&&Rn[t][e].apply(jn,n);else for(var i in Rn[t])Rn[t][i].apply(jn,n);return jn}function B(t){return jn.f(t)[J](RegExp("("+_n.escape.join("|")[J](/\\/g,"\\\\")+")+"),"").trim()}function F(t){if(n[R]||n[q])return ln("");var e,i=B(Dn[V]);i&&(vn(i)?t&&fn("Tag %s already exists",[i]):(bn(i),hn(i),e=jn.tags.length,E("change",[i,e]),E("set.tag",[i,e])),ln(""))}function G(){F(1),u(An,"focus"),u(An,"focus.input"),E("blur",[wn,jn.tags.length])}function Q(){E("click",[jn.tags])}function Y(){a(An,"focus"),a(An,"focus.input"),E("focus",[jn.tags])}function Z(t){var e,i=_n.escape,a=t[N],r=t[K],s=t[L],c=k===r||13===a,f=t[U],l=w===r||9===a,g=Bn[P],d=jn.tags.length,p=_n.max,v=B(Dn[V]);c?r="\n":l&&(r="	"),l||(n[R]||n[q]?(c&&n[q]&&tn()&&Ln&&Ln.submit(),pn(t)):o(r,i)||o(a,i)?(p>d?F(1):(ln(""),fn("Maximum tags allowed is %d",[p])),pn(t)):c?(tn()&&Ln&&Ln.submit(),pn(t)):X(function(){var n=Dn[V],c=B(n);o(n.slice(-1),i)?(p>d?F(1):(ln(""),fn("Maximum tags allowed is %d",[p])),pn(t)):""!==c||s||f||(""!==v||x!==r&&8!==a?(h===r||37===a)&&g&&g.focus():(e=jn.tags[d-1],u(An,"focus.tag"),xn(e),mn(e),g&&(E("change",[e,d-1]),E("let.tag",[e,d-1])))),In[D]=c?"":Tn},0))}function $(t){if(An[H])for(var e;e=Bn[P];)xn(e.title);for(jn.tags=[],n.value="",t=t?t.split(_n.join):[],kn=_n.max,wn,yn=0;kn>yn&&t[yn];++yn)if(""!==(wn=B(t[yn]))){if(vn(wn))continue;bn(wn),hn(wn),E("change",[wn,yn]),E("set.tag",[wn,yn])}}function tn(t){if(!n[R]){var e=_n.min;return F(),e>0&&jn.tags.length<e?(ln("",1),fn("Minimum tags allowed is %d",[e]),void pn(t)):1}}function nn(){X(function(){n[R]||n[q]||$(Dn[V]),ln("")},0)}function en(t){t&&An===t.target&&(Dn.focus(),Q())}function un(){Dn.focus()}function an(){var t=this,n=t.title;u(An,"focus"),u(An,"focus.tag"),E("blur.tag",[n,i(n,jn.tags)])}function rn(){var t=this.title;E("click.tag",[t,i(t,jn.tags)])}function sn(){var t=this,n=t.title;a(An,"focus"),a(An,"focus.tag"),E("focus.tag",[n,i(n,jn.tags)])}function on(t){if(!n[R]&&!n[q]){var e=this[H].title;xn(e),mn(e),ln("",1)}pn(t)}function cn(t){var e=this,a=t[N],r=t[K],s=(t[L],t[U]),o=w===r||9===a,c=e[P],f=e[S];if(s&&o||h===r||37===a)c&&(c.focus(),pn(t));else if(o||b===r||39===a)f&&f!==Bn?f.focus():ln("",1),pn(t);else if(x===r||y===r||8===a||46===a){if(!n[q]){var l=e.title,g=i(l,jn.tags);u(An,"focus.tag"),xn(l),mn(l),x===r||8===a?c?c.focus():ln("",1):f&&f!==Bn?f.focus():ln("",1),E("change",[l,g]),E("let.tag",[l,g])}pn(t)}}function fn(t,n){var e,i=_n.alert;!0===i&&(e=Mn.i(t,n))?alert(e):c(i)?i.apply(jn,n):g(i)&&Mn[i]&&Mn[i].apply(jn,n)}function ln(t,n){Dn[V]=t,In[V]=t?"":Tn,n&&Dn.focus()}function gn(t,n,e){t.removeEventListener(n,e)}function dn(t,n,e){t.addEventListener(n,e,!1)}function pn(t){t&&t.preventDefault()}function vn(t,n){var e=i(t,jn.tags);return n&&E("get.tag",[t,e]),f(e)?t:null}function mn(t){var e=i(t,jn.tags);return f(e)&&e>=0?(jn.tags.splice(e,1),n.value=jn.tags.join(_n.join),!0):!1}function hn(t,e){f(e)?(e=0>e?0:e,jn.tags.splice(e,0,t)):jn.tags.push(t),n.value=jn.tags.join(_n.join)}function bn(t,e){var i=v("span",0,{"class":"tag",tabindex:n[R]?!1:"0",title:t});if(_n.x){var u=v("a",0,{href:"",tabindex:"-1",title:Mn.i("Remove tag %s",[t])});dn(u,"click",on),i[M](u)}dn(i,"blur",an),dn(i,"click",rn),dn(i,"focus",sn),dn(i,"keydown",cn),On[H]&&(f(e)&&jn.tags[e]?On[I](i,On[T][e]):On[I](i,Bn))}function xn(t){var n,e=i(t,jn.tags);if(f(e)&&e>=0&&(n=On.children[e])){if(gn(n,"blur",an),gn(n,"click",rn),gn(n,"focus",sn),gn(n,"keydown",cn),_n.x){var u=n[_];gn(u,"click",on),d(u)}return d(n),!0}return!1}if(n){var yn,kn,wn,jn=this,Mn=t[e],Tn=n.placeholder||"",Cn=n[O]("tabindex"),En={alert:!0,"class":"tag-picker",escape:[",",188],join:", ",max:9999,min:0,x:!1};if(n[e])return jn;if(!(jn instanceof Mn))return new Mn(n,p);Mn[j][n.id||n.name||r(Mn[j])]=jn,n[e]=1,g(p)&&(p={join:p});var Ln,Rn={},_n=s(En,p),An=v("span",0,{"class":_n["class"]}),On=v("span",0,{"class":"tags"}),Bn=v("span",0,{"class":"editor tag"}),Dn=v("span",0,{contenteditable:n[R]?!1:"true",spellcheck:"false",style:"white-space:pre;"}),In=v("span");for(jn.f=function(t){return t[W]()[J](/[^ a-z0-9-]/g,"")},ln(""),a(n,_n["class"]+"-source"),n[H][I](An,n[S]),An[M](On),On[M](Bn),Bn[M](Dn),Bn[M](In),v(n,0,{tabindex:"-1"}),Ln=n[H];Ln&&Ln[z]&&"form"!==Ln[z][W]();)Ln=Ln[H];dn(Dn,"blur",G),dn(Dn,"click",Q),dn(Dn,"focus",Y),dn(Dn,"keydown",Z),dn(Dn,"paste",nn),dn(n,"focus",un),dn(An,"click",en),Ln&&dn(Ln,"submit",tn),jn.tags=[],$(n.value),jn.input=Dn,jn.self=jn.view=An,jn.source=jn.output=n,jn.state=_n,jn.blur=function(){return!n[R]&&(Dn.blur(),G()),jn},jn.click=function(){return An.click(),en(),jn},jn.fire=function(t,n,e){return E(t,n,e)},jn.focus=function(){return n[R]||(Dn.focus(),Y()),jn},jn.get=function(t){return n[R]?null:vn(t,1)},jn.let=function(t,e){if(!n[R]&&!n[q]){var i=_n.min;if(F(),e&&i>0&&jn.tags.length<i)return fn("Minimum tags allowed is %d",[i]),jn;xn(t),mn(t)}return jn},jn.on=function(t,n,e){return m(t,n,e)},jn.off=function(t,n){return C(t,n)},jn.pop=function(){return n[e]?(delete n[e],gn(Dn,"blur",G),gn(Dn,"click",Q),gn(Dn,"focus",Y),gn(Dn,"keydown",Z),gn(Dn,"paste",nn),gn(n,"focus",un),gn(An,"click",en),Ln&&gn(Ln,"submit",tn),jn.tags[A](xn),u(n,_n["class"]+"-source"),v(n,0,{tabindex:Cn}),d(An),E("pop")):jn},jn.set=function(t,e,i){if(!n[R]&&!n[q])if(vn(t))i&&fn("Tag %s already exists",[t]);else{var u=_n.max;jn.tags.length<u?(bn(t,e),hn(t,e)):i&&fn("Maximum tags allowed is %d",[u])}return jn},jn.value=function(t){return!n[R]&&!n[q]&&$(t),jn}}})}(window,document,"TP");