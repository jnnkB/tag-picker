/*!
 * ==========================================================
 *  TAG PICKER PLUGIN 3.0.1
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
!function(t,n,e){function i(t,n){var e=n[S](t);return 0>e?null:e}function a(t,n){return t[T].remove(n)}function u(t,n){return t[T].add(n)}function r(t){return Object.keys(t).length}function s(t,n){return Object.assign(t,n)}function c(t,n){return n[S](t)>=0}function o(t){return"function"==typeof t}function f(t){return"number"==typeof t}function l(t){return void 0!==t}function g(t){return"string"==typeof t}function p(t){d(t)&&t[z][q](t)}function d(t){return t&&t[z]}function v(t,e,i){var a,u,r=g(t)?n[E](t):t;if((e||""===e)&&(r[A]=e),i)for(a in i)u=i[a],null===u||!1===u?r[P](a):r[G](a,u);return r}var m="Arrow",h=m+"Left",k=m+"Right",y="Backspace",x="Delete",b="Enter",w="Tab",j="appendChild",M="children",T="classList",C="concat",E="createElement",L="ctrlKey",R="firstChild",_="forEach",S="indexOf",A="innerHTML",O="insertBefore",B="__instance__",D="key",I=D+"Code",K="nextSibling",N="nodeName",z="parentNode",H="previousSibling",P="removeAttribute",q="removeChild",F="replace",G="setAttribute",J="shiftKey",Q="textContent",U="toLowerCase",V=setTimeout;!function(n){n.version="3.0.1",n[B]={},n.each=function(t,e){return V(function(){var e,i=n[B];for(e in i)t.call(i[e],e,i)},0===e?0:e||1),n},n.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},n.i=function(n,i){return n=t[e].I[n]||n,i&&i[_](function(t){n=n.replace("%"+(f(t)?"d":"s"),t)}),n}}(t[e]=function(n,d){function m(t,n,e){return l(Cn[t])||(Cn[t]={}),l(e)||(e=r(Cn[t])),Cn[t][e]=n,bn}function T(t,n){return l(t)?l(n)?(delete Cn[t][n],bn):(Cn[t]={},bn):(Cn={},bn)}function E(t,n,e){if(!l(Cn[t]))return bn;if(l(e))l(Cn[t][e])&&Cn[t][e].apply(bn,n);else for(var i in Cn[t])Cn[t][i].apply(bn,n);return bn}function S(t){return bn.f(t)[F](RegExp("("+En.escape.join("|")[F](/\\/g,"\\\\")+")+"),"").trim()}function P(t){var n,e=S(Sn[Q]);e&&(pn(e)?t&&cn("Tag %s already exists",[e]):(mn(e),vn(e),n=bn.tags.length,E("change",[e,n]),E("set.tag",[e,n])),on(""))}function q(){P(1),a(Ln,"focus"),a(Ln,"focus.input"),E("blur",[xn,bn.tags.length])}function G(){E("click",[bn.tags])}function W(){u(Ln,"focus"),u(Ln,"focus.input"),E("focus",[bn.tags])}function X(t){var n,e=En.escape,i=t[I],u=t[D],r=t[L],s=t[J],o=_n[H],f=bn.tags.length,l=En.max,g=S(Sn[Q]);b===u||13===i?u="\n":(w===u||9===i)&&(u="	"),c(u,e)||c(i,e)?(l>f?P(1):(on(""),cn("Maximum tags allowed is %d",[l])),gn(t)):"\n"===u?(Z(),gn(t)):(s||"	"!==u)&&V(function(){var t=Sn[Q],e=S(t);""!==e||r||s||(""!==g||y!==u&&8!==i?(h===u||37===i)&&o&&o.focus():(n=bn.tags[f-1],a(Ln,"focus.tag"),hn(n),dn(n),o&&(E("change",[n,f-1]),E("let.tag",[n,f-1])))),An[A]=e?"":jn},1)}function Y(t){if(Ln[z])for(var e;e=_n[H];)hn(e.title);for(bn.tags=[],n.value="",t=t?t.split(En.join):[],yn=En.max,xn,kn=0;yn>kn&&t[kn];++kn)if(""!==(xn=S(t[kn]))){if(pn(xn))continue;mn(xn),vn(xn),E("change",[xn,kn]),E("set.tag",[xn,kn])}}function Z(t){var n=En.min;P(),n>0&&bn.tags.length<n&&(on("",1),cn("Minimum tags allowed is %d",[n]),gn(t))}function $(){V(function(){Y(Sn[Q]),on("")},1)}function tn(t){t&&Ln===t.target&&(Sn.focus(),G())}function nn(){Sn.focus()}function en(){var t=this,n=t.title;a(Ln,"focus"),a(Ln,"focus.tag"),E("blur.tag",[n,i(n,bn.tags)])}function an(){var t=this.title;E("click.tag",[t,i(t,bn.tags)])}function un(){var t=this,n=t.title;u(Ln,"focus"),u(Ln,"focus.tag"),E("focus.tag",[n,i(n,bn.tags)])}function rn(t){var n=this[z].title;hn(n),dn(n),on("",1),gn(t)}function sn(t){var n=this,e=t[I],u=t[D],r=t[L],s=t[J],c=n[H],o=n[K];if(!r&&!s)if(h===u||37===e)c&&c.focus();else if(k===u||39===e)o&&o!==_n?o.focus():on("",1);else if(y===u||x===u||8===e||46===e){var f=n.title,l=i(f,bn.tags);a(Ln,"focus.tag"),hn(f),dn(f),y===u||8===e?c?c.focus():on("",1):o&&o!==_n?o.focus():on("",1),E("change",[f,l]),E("let.tag",[f,l])}gn(t)}function cn(t,n){var e,i=En.alert;!0===i&&(e=wn.i(t,n))?alert(e):o(i)?i.apply(bn,n):g(i)&&wn[i]&&wn[i].apply(bn,n)}function on(t,n){Sn[Q]=t,An[Q]=t?"":jn,n&&Sn.focus()}function fn(t,n,e){t.removeEventListener(n,e)}function ln(t,n,e){t.addEventListener(n,e,!1)}function gn(t){t&&t.preventDefault()}function pn(t,n){var e=i(t,bn.tags);return n&&E("get.tag",[t,e]),f(e)?t:null}function dn(t){var e=i(t,bn.tags);return f(e)&&e>=0?(bn.tags.splice(e,1),n.value=bn.tags.join(En.join),!0):!1}function vn(t,e){f(e)?(e=0>e?0:e,bn.tags=bn.tags.splice(0,e)[C]([t])[C](bn.tags.splice(e-1))):bn.tags.push(t),n.value=bn.tags.join(En.join)}function mn(t,n){var e=v("span","",{"class":"tag",tabindex:"1",title:t});if(En.x){var i=v("a","",{href:"",title:wn.i("Remove tag %s",[t])});ln(i,"click",rn),e[j](i)}ln(e,"blur",en),ln(e,"click",an),ln(e,"focus",un),ln(e,"keydown",sn),Rn[z]&&(f(n)&&bn.tags[n]?Rn[O](e,Rn[M][n]):Rn[O](e,_n))}function hn(t){var n,e=i(t,bn.tags);if(f(e)&&e>=0&&(n=Rn.children[e])){if(fn(n,"blur",en),fn(n,"click",an),fn(n,"focus",un),fn(n,"keydown",sn),En.x){var a=n[R];fn(a,"click",rn),p(a)}return p(n),!0}return!1}if(n){var kn,yn,xn,bn=this,wn=t[e],jn=n.placeholder||"",Mn={alert:!0,"class":"tag-picker",escape:[",",188],join:", ",max:9999,min:0,x:!1};if(n[e])return bn;if(!(bn instanceof wn))return new wn(n,d);wn[B][n.id||n.name||r(wn[B])]=bn,n[e]=1,g(d)&&(d={join:d});var Tn,Cn={},En=s(Mn,d),Ln=v("span","",{"class":En["class"]}),Rn=v("span","",{"class":"tags"}),_n=v("span","",{"class":"editor tag"}),Sn=v("span","",{contenteditable:"true",spellcheck:"false",style:"white-space:pre;"}),An=v("span");for(bn.f=function(t){return t[U]()[F](/[^ a-z0-9-]/g,"")},on(""),u(n,En["class"]+"-source"),n[z][O](Ln,n),Ln[j](Rn),Rn[j](_n),_n[j](Sn),_n[j](An),Tn=n[z];Tn&&Tn[N]&&"form"!==Tn[N][U]();)Tn=Tn[z];ln(Sn,"blur",q),ln(Sn,"click",G),ln(Sn,"focus",W),ln(Sn,"keydown",X),ln(Sn,"paste",$),ln(n,"focus",nn),ln(Ln,"click",tn),Tn&&ln(Tn,"submit",Z),bn.tags=[],Y(n.value),bn.input=Sn,bn.self=bn.view=Ln,bn.source=bn.output=n,bn.state=En,bn.blur=function(){return Sn.blur(),q(),bn},bn.click=function(){return Ln.click(),tn(),bn},bn.fire=function(t,n,e){return E(t,n,e)},bn.focus=function(){return Sn.focus(),W(),bn},bn.get=function(t){return pn(t,1),bn},bn.let=function(t,n){var e=En.min;return P(),n&&e>0&&bn.tags.length<e?(cn("Minimum tags allowed is %d",[e]),bn):(hn(t),dn(t),bn)},bn.on=function(t,n,e){return m(t,n,e)},bn.off=function(t,n){return T(t,n)},bn.pop=function(){return n[e]?(delete n[e],fn(Sn,"blur",q),fn(Sn,"click",G),fn(Sn,"focus",W),fn(Sn,"keydown",X),fn(Sn,"paste",$),fn(n,"focus",nn),fn(Ln,"click",tn),Tn&&fn(Tn,"submit",Z),bn.tags[_](hn),a(n,En["class"]+"-source"),p(Ln),E("pop")):bn},bn.set=function(t,n,e){if(pn(t))e&&cn("Tag %s already exists",[t]);else{var i=En.max;bn.tags.length<i?(mn(t,n),vn(t,n)):e&&cn("Maximum tags allowed is %d",[i])}return bn},bn.value=function(t){return Y(t),bn}}})}(window,document,"TP");