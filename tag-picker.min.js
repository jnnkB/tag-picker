/*!
 * ==========================================================
 *  TAG PICKER PLUGIN 3.0.1
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
!function(t,n,e){function i(t,n){var e=n[A](t);return 0>e?null:e}function a(t,n){return t[C].remove(n)}function u(t,n){return t[C].add(n)}function r(t){return Object.keys(t).length}function s(t,n){return Object.assign(t,n)}function c(t,n){return n[A](t)>=0}function o(t){return"function"==typeof t}function f(t){return"number"==typeof t}function l(t){return void 0!==t}function g(t){return"string"==typeof t}function p(t){d(t)&&t[H][F](t)}function d(t){return t&&t[H]}function v(t,e,i){var a,u,r=g(t)?n[E](t):t;if((e||""===e)&&(r[O]=e),i)for(a in i)u=i[a],null===u||!1===u?r[q](a):r[J](a,u);return r}var m="Arrow",h=m+"Left",k=m+"Right",y="Backspace",x="Delete",b="Enter",w="Tab",j="appendChild",M="children",C="classList",T="concat",E="createElement",L="ctrlKey",R="firstChild",S="forEach",_="fromCharCode",A="indexOf",O="innerHTML",B="insertBefore",D="__instance__",I="key",K=I+"Code",N="nextSibling",z="nodeName",H="parentNode",P="previousSibling",q="removeAttribute",F="removeChild",G="replace",J="setAttribute",Q="shiftKey",U="textContent",V="toLowerCase",W=setTimeout;!function(n){n.version="3.0.1",n[D]={},n.each=function(t,e){return W(function(){var e,i=n[D];for(e in i)t.call(i[e],e,i)},0===e?0:e||1),n},n.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},n.i=function(n,i){return n=t[e].I[n]||n,i&&i[S](function(t){n=n.replace("%"+(f(t)?"d":"s"),t)}),n}}(t[e]=function(n,d){function m(t,n,e){return l(En[t])||(En[t]={}),l(e)||(e=r(En[t])),En[t][e]=n,wn}function C(t,n){return l(t)?l(n)?(delete En[t][n],wn):(En[t]={},wn):(En={},wn)}function E(t,n,e){if(!l(En[t]))return wn;if(l(e))l(En[t][e])&&En[t][e].apply(wn,n);else for(var i in En[t])En[t][i].apply(wn,n);return wn}function A(t){return wn.f(t)[G](RegExp("("+Ln.escape.join("|")[G](/\\/g,"\\\\")+")+"),"").trim()}function q(t){var n,e=A(An[U]);e&&(dn(e)?t&&on("Tag %s already exists",[e]):(hn(e),mn(e),n=wn.tags.length,E("change",[e,n]),E("set.tag",[e,n])),fn(""))}function F(){q(1),a(Rn,"focus"),a(Rn,"focus.input"),E("blur",[bn,wn.tags.length])}function J(){E("click",[wn.tags])}function X(){u(Rn,"focus"),u(Rn,"focus.input"),E("focus",[wn.tags])}function Y(t){var n,e=Ln.escape,i=t[K],u=t[I]||String[_](i),r=t[L],s=t[Q],o=_n[P],f=wn.tags.length,l=Ln.max,g=A(An[U]);b===u?u="\n":w===u&&(u="	"),c(u,e)?(l>f?q(1):(fn(""),on("Maximum tags allowed is %d",[l])),pn(t)):"\n"===u||13===i?($(),pn(t)):(s||"	"!==u&&9!==i)&&W(function(){var t=An[U],e=A(t);""!==e||r||s||(""!==g||y!==u&&8!==i?(h===u||37===i)&&o&&o.focus():(n=wn.tags[f-1],a(Rn,"focus.tag"),kn(n),vn(n),o&&(E("change",[n,f-1]),E("let.tag",[n,f-1])))),On[O]=e?"":Mn},1)}function Z(t){if(Rn[H])for(var e;e=_n[P];)kn(e.title);for(wn.tags=[],n.value="",t=t?t.split(Ln.join):[],xn=Ln.max,bn,yn=0;xn>yn&&t[yn];++yn)if(""!==(bn=A(t[yn]))){if(dn(bn))continue;hn(bn),mn(bn),E("change",[bn,yn]),E("set.tag",[bn,yn])}}function $(t){var n=Ln.min;q(),n>0&&wn.tags.length<n&&(fn("",1),on("Minimum tags allowed is %d",[n]),pn(t))}function tn(){W(function(){Z(An[U]),fn("")},1)}function nn(t){t&&Rn===t.target&&(An.focus(),J())}function en(){An.focus()}function an(){var t=this,n=t.title;a(Rn,"focus"),a(Rn,"focus.tag"),E("blur.tag",[n,i(n,wn.tags)])}function un(){var t=this.title;E("click.tag",[t,i(t,wn.tags)])}function rn(){var t=this,n=t.title;u(Rn,"focus"),u(Rn,"focus.tag"),E("focus.tag",[n,i(n,wn.tags)])}function sn(t){var n=this[H].title;kn(n),vn(n),fn("",1),pn(t)}function cn(t){var n=this,e=t[K],u=t[I]||String[_](e),r=t[L],s=t[Q],c=n[P],o=n[N];if(!r&&!s)if(h===u||37===e)c&&c.focus();else if(k===u||39===e)o&&o!==_n?o.focus():fn("",1);else if(y===u||x===u||8===e||46===e){var f=n.title,l=i(f,wn.tags);a(Rn,"focus.tag"),kn(f),vn(f),y===u||8===e?c?c.focus():fn("",1):o&&o!==_n?o.focus():fn("",1),E("change",[f,l]),E("let.tag",[f,l])}pn(t)}function on(t,n){var e,i=Ln.alert;!0===i&&(e=jn.i(t,n))?alert(e):o(i)?i.apply(wn,n):g(i)&&jn[i]&&jn[i].apply(wn,n)}function fn(t,n){An[U]=t,On[U]=t?"":Mn,n&&An.focus()}function ln(t,n,e){t.removeEventListener(n,e)}function gn(t,n,e){t.addEventListener(n,e,!1)}function pn(t){t&&t.preventDefault()}function dn(t,n){var e=i(t,wn.tags);return n&&E("get.tag",[t,e]),f(e)?t:null}function vn(t){var e=i(t,wn.tags);return f(e)&&e>=0?(wn.tags.splice(e,1),n.value=wn.tags.join(Ln.join),!0):!1}function mn(t,e){f(e)?(e=0>e?0:e,wn.tags=wn.tags.splice(0,e)[T]([t])[T](wn.tags.splice(e-1))):wn.tags.push(t),n.value=wn.tags.join(Ln.join)}function hn(t,n){var e=v("span","",{"class":"tag",tabindex:"1",title:t});if(Ln.x){var i=v("a","",{href:"",title:jn.i("Remove tag %s",[t])});gn(i,"click",sn),e[j](i)}gn(e,"blur",an),gn(e,"click",un),gn(e,"focus",rn),gn(e,"keydown",cn),Sn[H]&&(f(n)&&wn.tags[n]?Sn[B](e,Sn[M][n]):Sn[B](e,_n))}function kn(t){var n,e=i(t,wn.tags);if(f(e)&&e>=0&&(n=Sn.children[e])){if(ln(n,"blur",an),ln(n,"click",un),ln(n,"focus",rn),ln(n,"keydown",cn),Ln.x){var a=n[R];ln(a,"click",sn),p(a)}return p(n),!0}return!1}if(n){var yn,xn,bn,wn=this,jn=t[e],Mn=n.placeholder||"",Cn={alert:!0,"class":"tag-picker",escape:[","],join:", ",max:9999,min:0,x:!1};if(n[e])return wn;if(!(wn instanceof jn))return new jn(n,d);jn[D][n.id||n.name||r(jn[D])]=wn,n[e]=1,g(d)&&(d={join:d});var Tn,En={},Ln=s(Cn,d),Rn=v("span","",{"class":Ln["class"]}),Sn=v("span","",{"class":"tags"}),_n=v("span","",{"class":"editor tag"}),An=v("span","",{contenteditable:"true",spellcheck:"false",style:"white-space:pre;"}),On=v("span");for(wn.f=function(t){return t[V]()[G](/[^ a-z0-9-]/g,"")},fn(""),u(n,Ln["class"]+"-source"),n[H][B](Rn,n),Rn[j](Sn),Sn[j](_n),_n[j](An),_n[j](On),Tn=n[H];Tn&&Tn[z]&&"form"!==Tn[z][V]();)Tn=Tn[H];gn(An,"blur",F),gn(An,"click",J),gn(An,"focus",X),gn(An,"keydown",Y),gn(An,"paste",tn),gn(n,"focus",en),gn(Rn,"click",nn),Tn&&gn(Tn,"submit",$),wn.tags=[],Z(n.value),wn.input=An,wn.self=wn.view=Rn,wn.source=wn.output=n,wn.state=Ln,wn.blur=function(){return An.blur(),F(),wn},wn.click=function(){return Rn.click(),nn(),wn},wn.fire=function(t,n,e){return E(t,n,e)},wn.focus=function(){return An.focus(),X(),wn},wn.get=function(t){return dn(t,1),wn},wn.let=function(t,n){var e=Ln.min;return q(),n&&e>0&&wn.tags.length<e?(on("Minimum tags allowed is %d",[e]),wn):(kn(t),vn(t),wn)},wn.on=function(t,n,e){return m(t,n,e)},wn.off=function(t,n){return C(t,n)},wn.pop=function(){return n[e]?(delete n[e],ln(An,"blur",F),ln(An,"click",J),ln(An,"focus",X),ln(An,"keydown",Y),ln(An,"paste",tn),ln(n,"focus",en),ln(Rn,"click",nn),Tn&&ln(Tn,"submit",$),wn.tags[S](kn),a(n,Ln["class"]+"-source"),p(Rn),E("pop")):wn},wn.set=function(t,n,e){if(dn(t))e&&on("Tag %s already exists",[t]);else{var i=Ln.max;wn.tags.length<i?(hn(t,n),mn(t,n)):e&&on("Maximum tags allowed is %d",[i])}return wn},wn.value=function(t){return Z(t),wn}}})}(window,document,"TP");