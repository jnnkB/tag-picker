/*!
 * ==========================================================
 *  TAG PICKER PLUGIN 3.0.2
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
!function(t,n,e){function i(t,n){var e=n[A](t);return 0>e?null:e}function a(t,n){return t[T].remove(n)}function u(t,n){return t[T].add(n)}function s(t){return Object.keys(t).length}function c(t,n){return Object.assign(t,n)}function r(t,n){return n[A](t)>=0}function o(t){return"function"==typeof t}function f(t){return"number"==typeof t}function l(t){return void 0!==t}function g(t){return"string"==typeof t}function d(t){p(t)&&t[z][q](t)}function p(t){return t&&t[z]}function v(t,e,i){var a,u,s=g(t)?n[E](t):t;if((e||""===e)&&(s[O]=e),i)for(a in i)u=i[a],null===u||!1===u?s[P](a):s[G](a,u);return s}var m="Arrow",h=m+"Left",k=m+"Right",x="Backspace",b="Delete",w="Enter",y="Tab",j="appendChild",M="children",T="classList",C="concat",E="createElement",L="ctrlKey",R="firstChild",_="forEach",A="indexOf",O="innerHTML",B="insertBefore",D="__instance__",I="key",K=I+"Code",N="nextSibling",S="nodeName",z="parentNode",H="previousSibling",P="removeAttribute",q="removeChild",F="replace",G="setAttribute",J="shiftKey",Q="textContent",U="toLowerCase",V=setTimeout;!function(n){n.version="3.0.2",n[D]={},n.each=function(t,e){return V(function(){var e,i=n[D];for(e in i)t.call(i[e],e,i)},0===e?0:e||1),n},n.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},n.i=function(n,i){return n=t[e].I[n]||n,i&&i[_](function(t){n=n.replace("%"+(f(t)?"d":"s"),t)}),n}}(t[e]=function(n,p){function m(t,n,e){return l(Cn[t])||(Cn[t]={}),l(e)||(e=s(Cn[t])),Cn[t][e]=n,wn}function T(t,n){return l(t)?l(n)?(delete Cn[t][n],wn):(Cn[t]={},wn):(Cn={},wn)}function E(t,n,e){if(!l(Cn[t]))return wn;if(l(e))l(Cn[t][e])&&Cn[t][e].apply(wn,n);else for(var i in Cn[t])Cn[t][i].apply(wn,n);return wn}function A(t){return wn.f(t)[F](RegExp("("+En.escape.join("|")[F](/\\/g,"\\\\")+")+"),"").trim()}function P(t){var n,e=A(An[Q]);e&&(dn(e)?t&&rn("Tag %s already exists",[e]):(mn(e),vn(e),n=wn.tags.length,E("change",[e,n]),E("set.tag",[e,n])),on(""))}function q(){P(1),a(Ln,"focus"),a(Ln,"focus.input"),E("blur",[bn,wn.tags.length])}function G(){E("click",[wn.tags])}function W(){u(Ln,"focus"),u(Ln,"focus.input"),E("focus",[wn.tags])}function X(t){var n,e=En.escape,i=t[K],u=t[I],s=t[L],c=t[J],o=_n[H],f=wn.tags.length,l=En.max,g=A(An[Q]);w===u||13===i?u="\n":(y===u||9===i)&&(u="	"),r(u,e)||r(i,e)?(l>f?P(1):(on(""),rn("Maximum tags allowed is %d",[l])),gn(t)):"\n"===u?(Z(),gn(t)):(c||"	"!==u)&&V(function(){var d=An[Q],p=A(d);r(d.slice(-1),e)?(l>f?P(1):(on(""),rn("Maximum tags allowed is %d",[l])),gn(t)):""!==p||s||c||(""!==g||x!==u&&8!==i?(h===u||37===i)&&o&&o.focus():(n=wn.tags[f-1],a(Ln,"focus.tag"),hn(n),pn(n),o&&(E("change",[n,f-1]),E("let.tag",[n,f-1])))),On[O]=p?"":jn},1)}function Y(t){if(Ln[z])for(var e;e=_n[H];)hn(e.title);for(wn.tags=[],n.value="",t=t?t.split(En.join):[],xn=En.max,bn,kn=0;xn>kn&&t[kn];++kn)if(""!==(bn=A(t[kn]))){if(dn(bn))continue;mn(bn),vn(bn),E("change",[bn,kn]),E("set.tag",[bn,kn])}}function Z(t){var n=En.min;P(),n>0&&wn.tags.length<n&&(on("",1),rn("Minimum tags allowed is %d",[n]),gn(t))}function $(){V(function(){Y(An[Q]),on("")},1)}function tn(t){t&&Ln===t.target&&(An.focus(),G())}function nn(){An.focus()}function en(){var t=this,n=t.title;a(Ln,"focus"),a(Ln,"focus.tag"),E("blur.tag",[n,i(n,wn.tags)])}function an(){var t=this.title;E("click.tag",[t,i(t,wn.tags)])}function un(){var t=this,n=t.title;u(Ln,"focus"),u(Ln,"focus.tag"),E("focus.tag",[n,i(n,wn.tags)])}function sn(t){var n=this[z].title;hn(n),pn(n),on("",1),gn(t)}function cn(t){var n=this,e=t[K],u=t[I],s=t[L],c=t[J],r=n[H],o=n[N];if(!s&&!c)if(h===u||37===e)r&&r.focus();else if(k===u||39===e)o&&o!==_n?o.focus():on("",1);else if(x===u||b===u||8===e||46===e){var f=n.title,l=i(f,wn.tags);a(Ln,"focus.tag"),hn(f),pn(f),x===u||8===e?r?r.focus():on("",1):o&&o!==_n?o.focus():on("",1),E("change",[f,l]),E("let.tag",[f,l])}gn(t)}function rn(t,n){var e,i=En.alert;!0===i&&(e=yn.i(t,n))?alert(e):o(i)?i.apply(wn,n):g(i)&&yn[i]&&yn[i].apply(wn,n)}function on(t,n){An[Q]=t,On[Q]=t?"":jn,n&&An.focus()}function fn(t,n,e){t.removeEventListener(n,e)}function ln(t,n,e){t.addEventListener(n,e,!1)}function gn(t){t&&t.preventDefault()}function dn(t,n){var e=i(t,wn.tags);return n&&E("get.tag",[t,e]),f(e)?t:null}function pn(t){var e=i(t,wn.tags);return f(e)&&e>=0?(wn.tags.splice(e,1),n.value=wn.tags.join(En.join),!0):!1}function vn(t,e){f(e)?(e=0>e?0:e,wn.tags=wn.tags.splice(0,e)[C]([t])[C](wn.tags.splice(e-1))):wn.tags.push(t),n.value=wn.tags.join(En.join)}function mn(t,n){var e=v("span","",{"class":"tag",tabindex:"1",title:t});if(En.x){var i=v("a","",{href:"",title:yn.i("Remove tag %s",[t])});ln(i,"click",sn),e[j](i)}ln(e,"blur",en),ln(e,"click",an),ln(e,"focus",un),ln(e,"keydown",cn),Rn[z]&&(f(n)&&wn.tags[n]?Rn[B](e,Rn[M][n]):Rn[B](e,_n))}function hn(t){var n,e=i(t,wn.tags);if(f(e)&&e>=0&&(n=Rn.children[e])){if(fn(n,"blur",en),fn(n,"click",an),fn(n,"focus",un),fn(n,"keydown",cn),En.x){var a=n[R];fn(a,"click",sn),d(a)}return d(n),!0}return!1}if(n){var kn,xn,bn,wn=this,yn=t[e],jn=n.placeholder||"",Mn={alert:!0,"class":"tag-picker",escape:[",",188],join:", ",max:9999,min:0,x:!1};if(n[e])return wn;if(!(wn instanceof yn))return new yn(n,p);yn[D][n.id||n.name||s(yn[D])]=wn,n[e]=1,g(p)&&(p={join:p});var Tn,Cn={},En=c(Mn,p),Ln=v("span","",{"class":En["class"]}),Rn=v("span","",{"class":"tags"}),_n=v("span","",{"class":"editor tag"}),An=v("span","",{contenteditable:"true",spellcheck:"false",style:"white-space:pre;"}),On=v("span");for(wn.f=function(t){return t[U]()[F](/[^ a-z0-9-]/g,"")},on(""),u(n,En["class"]+"-source"),n[z][B](Ln,n),Ln[j](Rn),Rn[j](_n),_n[j](An),_n[j](On),Tn=n[z];Tn&&Tn[S]&&"form"!==Tn[S][U]();)Tn=Tn[z];ln(An,"blur",q),ln(An,"click",G),ln(An,"focus",W),ln(An,"keydown",X),ln(An,"paste",$),ln(n,"focus",nn),ln(Ln,"click",tn),Tn&&ln(Tn,"submit",Z),wn.tags=[],Y(n.value),wn.input=An,wn.self=wn.view=Ln,wn.source=wn.output=n,wn.state=En,wn.blur=function(){return An.blur(),q(),wn},wn.click=function(){return Ln.click(),tn(),wn},wn.fire=function(t,n,e){return E(t,n,e)},wn.focus=function(){return An.focus(),W(),wn},wn.get=function(t){return dn(t,1),wn},wn.let=function(t,n){var e=En.min;return P(),n&&e>0&&wn.tags.length<e?(rn("Minimum tags allowed is %d",[e]),wn):(hn(t),pn(t),wn)},wn.on=function(t,n,e){return m(t,n,e)},wn.off=function(t,n){return T(t,n)},wn.pop=function(){return n[e]?(delete n[e],fn(An,"blur",q),fn(An,"click",G),fn(An,"focus",W),fn(An,"keydown",X),fn(An,"paste",$),fn(n,"focus",nn),fn(Ln,"click",tn),Tn&&fn(Tn,"submit",Z),wn.tags[_](hn),a(n,En["class"]+"-source"),d(Ln),E("pop")):wn},wn.set=function(t,n,e){if(dn(t))e&&rn("Tag %s already exists",[t]);else{var i=En.max;wn.tags.length<i?(mn(t,n),vn(t,n)):e&&rn("Maximum tags allowed is %d",[i])}return wn},wn.value=function(t){return Y(t),wn}}})}(window,document,"TP");