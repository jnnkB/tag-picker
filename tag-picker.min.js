/*!
 * ==========================================================
 *  TAG PICKER PLUGIN 3.0.3
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
!function(e,t,n){function r(e,t){var n=t[_](e);return 0>n?null:n}function i(e,t){return e[C].remove(t)}function u(e,t){return e[C].add(t)}function o(e){return Object.keys(e).length}function a(e,t){return Object.assign(e,t)}function s(e,t){return t[_](e)>=0}function c(e){return"function"==typeof e}function f(e){return"number"==typeof e}function l(e){return void 0!==e}function d(e){return"string"==typeof e}function g(e){v(e)&&e[z][B](e)}function v(e){return e&&e[z]}function p(e,n,r){var i,u,o=d(e)?t[T](e):e;if((n||""===n)&&(o[M]=n),r)for(i in r)u=r[i],null===u||!1===u?o[H](i):o[X](i,u);return o}var h="Arrow",m=h+"Left",b=h+"Right",y="Backspace",w="Delete",x="Enter",k="Tab",E="appendChild",$="children",C="classList",T="createElement",L="ctrlKey",O="firstChild",j="forEach",R="getAttribute",_="indexOf",M="innerHTML",S="insertBefore",D="__instance__",I="key",K=I+"Code",W="nextSibling",A="nodeName",z="parentNode",N="previousSibling",H="removeAttribute",B="removeChild",P="replace",X="setAttribute",Y="shiftKey",q="textContent",F="toLowerCase",G=setTimeout;!function(e){e.version="3.0.3",e[D]={},e.each=function(t,n){var r,i;return G(function(){i=e[D];for(r in i)t.call(i[r],r)},0===n?0:n||1),e},e.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},e.i=function(t,n){return t=e.I[t]||t,n&&n[j](function(e){t=t[P]("%"+(f(e)?"d":"s"),e)}),t},e._=e.prototype}(e[n]=function(t,v){function h(e,t,n){return l(Tt[e])||(Tt[e]={}),l(n)||(n=o(Tt[e])),Tt[e][n]=t,wt}function C(e,t){return l(e)?l(t)?(delete Tt[e][t],wt):(Tt[e]={},wt):(Tt={},wt)}function T(e,t,n){if(!l(Tt[e]))return wt;if(l(n))l(Tt[e][n])&&Tt[e][n].apply(wt,t);else for(var r in Tt[e])Tt[e][r].apply(wt,t);return wt}function _(e){return wt.f(e)[P](RegExp("("+Lt.escape.join("|")[P](/\\/g,"\\\\")+")+"),"").trim()}function H(e){var t,n=_(_t[q]);n&&(dt(n)?e&&at("Tag %s already exists",[n]):(pt(n),vt(n),t=wt.tags.length,T("change",[n,t]),T("set.tag",[n,t])),st(""))}function B(){H(1),i(Ot,"focus"),i(Ot,"focus.input"),T("blur",[yt,wt.tags.length])}function X(){T("click",[wt.tags])}function J(){u(Ot,"focus"),u(Ot,"focus.input"),T("focus",[wt.tags])}function Q(e){var t,n=Lt.escape,r=e[K],u=e[I],o=e[L],a=x===u||13===r,c=e[Y],f=k===u||9===r,l=Rt[N],d=wt.tags.length,g=Lt.max,v=_(_t[q]);a?u="\n":f&&(u="	"),s(u,n)||s(r,n)?(g>d?H(1):(st(""),at("Maximum tags allowed is %d",[g])),lt(e)):a?(V()&&Ct&&Ct.submit(),lt(e)):!c&&f||G(function(){var a=_t[q],f=_(a);s(a.slice(-1),n)?(g>d?H(1):(st(""),at("Maximum tags allowed is %d",[g])),lt(e)):""!==f||o||c||(""!==v||y!==u&&8!==r?(m===u||37===r)&&l&&l.focus():(t=wt.tags[d-1],i(Ot,"focus.tag"),ht(t),gt(t),l&&(T("change",[t,d-1]),T("let.tag",[t,d-1])))),Mt[M]=f?"":kt},0)}function U(e){if(Ot[z])for(var n;n=Rt[N];)ht(n.title);for(wt.tags=[],t.value="",e=e?e.split(Lt.join):[],bt=Lt.max,yt,mt=0;bt>mt&&e[mt];++mt)if(""!==(yt=_(e[mt]))){if(dt(yt))continue;pt(yt),vt(yt),T("change",[yt,mt]),T("set.tag",[yt,mt])}}function V(e){var t=Lt.min;return H(),t>0&&wt.tags.length<t?(st("",1),at("Minimum tags allowed is %d",[t]),lt(e),!1):!0}function Z(){G(function(){U(_t[q]),st("")},0)}function et(e){e&&Ot===e.target&&(_t.focus(),X())}function tt(){_t.focus()}function nt(){var e=this,t=e.title;i(Ot,"focus"),i(Ot,"focus.tag"),T("blur.tag",[t,r(t,wt.tags)])}function rt(){var e=this.title;T("click.tag",[e,r(e,wt.tags)])}function it(){var e=this,t=e.title;u(Ot,"focus"),u(Ot,"focus.tag"),T("focus.tag",[t,r(t,wt.tags)])}function ut(e){var t=this[z].title;ht(t),gt(t),st("",1),lt(e)}function ot(e){var t=this,n=e[K],u=e[I],o=(e[L],e[Y]),a=k===u||9===n,s=t[N],c=t[W];if(o&&a||m===u||37===n)s&&(s.focus(),lt(e));else if(a||b===u||39===n)c&&c!==Rt?c.focus():st("",1),lt(e);else if(y===u||w===u||8===n||46===n){var f=t.title,l=r(f,wt.tags);i(Ot,"focus.tag"),ht(f),gt(f),y===u||8===n?s?s.focus():st("",1):c&&c!==Rt?c.focus():st("",1),T("change",[f,l]),T("let.tag",[f,l]),lt(e)}}function at(e,t){var n,r=Lt.alert;!0===r&&(n=xt.i(e,t))?alert(n):c(r)?r.apply(wt,t):d(r)&&xt[r]&&xt[r].apply(wt,t)}function st(e,t){_t[q]=e,Mt[q]=e?"":kt,t&&_t.focus()}function ct(e,t,n){e.removeEventListener(t,n)}function ft(e,t,n){e.addEventListener(t,n,!1)}function lt(e){e&&e.preventDefault()}function dt(e,t){var n=r(e,wt.tags);return t&&T("get.tag",[e,n]),f(n)?e:null}function gt(e){var n=r(e,wt.tags);return f(n)&&n>=0?(wt.tags.splice(n,1),t.value=wt.tags.join(Lt.join),!0):!1}function vt(e,n){f(n)?(n=0>n?0:n,wt.tags.splice(n,0,e)):wt.tags.push(e),t.value=wt.tags.join(Lt.join)}function pt(e,t){var n=p("span",0,{"class":"tag",tabindex:"0",title:e});if(Lt.x){var r=p("a",0,{href:"",title:xt.i("Remove tag %s",[e])});ft(r,"click",ut),n[E](r)}ft(n,"blur",nt),ft(n,"click",rt),ft(n,"focus",it),ft(n,"keydown",ot),jt[z]&&(f(t)&&wt.tags[t]?jt[S](n,jt[$][t]):jt[S](n,Rt))}function ht(e){var t,n=r(e,wt.tags);if(f(n)&&n>=0&&(t=jt.children[n])){if(ct(t,"blur",nt),ct(t,"click",rt),ct(t,"focus",it),ct(t,"keydown",ot),Lt.x){var i=t[O];ct(i,"click",ut),g(i)}return g(t),!0}return!1}if(t){var mt,bt,yt,wt=this,xt=e[n],kt=t.placeholder||"",Et=t[R]("tabindex"),$t={alert:!0,"class":"tag-picker",escape:[",",188],join:", ",max:9999,min:0,x:!1};if(t[n])return wt;if(!(wt instanceof xt))return new xt(t,v);xt[D][t.id||t.name||o(xt[D])]=wt,t[n]=1,d(v)&&(v={join:v});var Ct,Tt={},Lt=a($t,v),Ot=p("span",0,{"class":Lt["class"]}),jt=p("span",0,{"class":"tags"}),Rt=p("span",0,{"class":"editor tag"}),_t=p("span",0,{contenteditable:"true",spellcheck:"false",style:"white-space:pre;"}),Mt=p("span");for(wt.f=function(e){return e[F]()[P](/[^ a-z0-9-]/g,"")},st(""),u(t,Lt["class"]+"-source"),t[z][S](Ot,t),Ot[E](jt),jt[E](Rt),Rt[E](_t),Rt[E](Mt),p(t,0,{tabindex:"-1"}),Ct=t[z];Ct&&Ct[A]&&"form"!==Ct[A][F]();)Ct=Ct[z];ft(_t,"blur",B),ft(_t,"click",X),ft(_t,"focus",J),ft(_t,"keydown",Q),ft(_t,"paste",Z),ft(t,"focus",tt),ft(Ot,"click",et),Ct&&ft(Ct,"submit",V),wt.tags=[],U(t.value),wt.input=_t,wt.self=wt.view=Ot,wt.source=wt.output=t,wt.state=Lt,wt.blur=function(){return _t.blur(),B(),wt},wt.click=function(){return Ot.click(),et(),wt},wt.fire=function(e,t,n){return T(e,t,n)},wt.focus=function(){return _t.focus(),J(),wt},wt.get=function(e){return dt(e,1),wt},wt.let=function(e,t){var n=Lt.min;return H(),t&&n>0&&wt.tags.length<n?(at("Minimum tags allowed is %d",[n]),wt):(ht(e),gt(e),wt)},wt.on=function(e,t,n){return h(e,t,n)},wt.off=function(e,t){return C(e,t)},wt.pop=function(){return t[n]?(delete t[n],ct(_t,"blur",B),ct(_t,"click",X),ct(_t,"focus",J),ct(_t,"keydown",Q),ct(_t,"paste",Z),ct(t,"focus",tt),ct(Ot,"click",et),Ct&&ct(Ct,"submit",V),wt.tags[j](ht),i(t,Lt["class"]+"-source"),p(t,0,{tabindex:Et}),g(Ot),T("pop")):wt},wt.set=function(e,t,n){if(dt(e))n&&at("Tag %s already exists",[e]);else{var r=Lt.max;wt.tags.length<r?(pt(e,t),vt(e,t)):n&&at("Maximum tags allowed is %d",[r])}return wt},wt.value=function(e){return U(e),wt}}})}(window,document,"TP");